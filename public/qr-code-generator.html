<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Shelf QR Codes Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .input-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .input-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }
        input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }
        button:hover {
            background: #45a049;
        }
        .qr-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .qr-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
            page-break-inside: avoid;
        }
        .qr-card h3 {
            margin: 0 0 15px 0;
            color: #333;
            font-size: 24px;
        }
        .qr-code {
            margin: 15px 0;
        }
        .instructions {
            font-size: 12px;
            color: #666;
            margin-top: 10px;
            text-align: left;
            background: #f9f9f9;
            padding: 10px;
            border-radius: 5px;
        }
        .shelf-id {
            font-family: monospace;
            font-size: 10px;
            color: #999;
            word-break: break-all;
        }
        @media print {
            body {
                background: white;
            }
            .header, .input-section {
                display: none;
            }
            .qr-card {
                box-shadow: none;
                border: 2px solid #333;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üö™ Smart Shelf QR Code Generator</h1>
        <p>Generate QR codes for your smart shelf door system</p>
    </div>

    <div class="input-section">
        <h2>üìã Generate QR Codes</h2>
        
        <div class="input-group">
            <label>QR Code Type:</label>
            <div style="margin-bottom: 15px;">
                <label style="display: inline-block; margin-right: 20px;">
                    <input type="radio" name="qrType" value="simple" checked onchange="toggleInput()"> 
                    Simple (Shelf Numbers Only) ‚≠ê Recommended
                </label>
                <label style="display: inline-block;">
                    <input type="radio" name="qrType" value="uuid" onchange="toggleInput()"> 
                    UUID (Database IDs)
                </label>
            </div>
        </div>

        <div id="simpleInput" class="input-group">
            <label for="shelfCount">Number of Shelves:</label>
            <input type="number" id="shelfCount" value="3" min="1" max="20" placeholder="e.g., 5">
        </div>

        <div id="uuidInput" class="input-group" style="display: none;">
            <label for="shelfData">Shelf Data (Shelf Number, UUID):</label>
            <textarea id="shelfData" rows="6" placeholder="Format: Shelf Number, Shelf ID (UUID)
Example:
1,de6735db-f9b2-45db-81b7-275cbc211735
2,4ee76eb4-3c14-4a4e-b869-2025edf3a5ca
3,abc12345-1234-1234-1234-123456789abc" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-family: monospace;"></textarea>
        </div>

        <button onclick="generateQRCodes()">üîÑ Generate QR Codes</button>
        <button onclick="window.print()" style="background: #2196F3; margin-left: 10px;">üñ®Ô∏è Print QR Codes</button>
    </div>

    <div id="qrContainer" class="qr-grid"></div>

    <script>
        // Sample UUID data
        const sampleData = `1,de6735db-f9b2-45db-81b7-275cbc211735
2,4ee76eb4-3c14-4a4e-b869-2025edf3a5ca`;

        // Set sample data on load
        document.getElementById('shelfData').value = sampleData;

        function toggleInput() {
            const qrType = document.querySelector('input[name="qrType"]:checked').value;
            document.getElementById('simpleInput').style.display = qrType === 'simple' ? 'block' : 'none';
            document.getElementById('uuidInput').style.display = qrType === 'uuid' ? 'block' : 'none';
        }

        function generateQRCodes() {
            const qrType = document.querySelector('input[name="qrType"]:checked').value;
            const container = document.getElementById('qrContainer');
            container.innerHTML = '';

            if (qrType === 'simple') {
                // Simple mode - just shelf numbers
                const shelfCount = parseInt(document.getElementById('shelfCount').value) || 3;
                
                for (let i = 1; i <= shelfCount; i++) {
                    createQRCard(i, i.toString(), 'Shelf Number');
                }
            } else {
                // UUID mode - shelf number + UUID
                const shelfData = document.getElementById('shelfData').value;
                const lines = shelfData.trim().split('\n');

                lines.forEach(line => {
                    const [shelfNumber, shelfId] = line.split(',').map(s => s.trim());
                    if (!shelfNumber || !shelfId) return;
                    createQRCard(shelfNumber, shelfId, 'UUID');
                });
            }
        }

        function createQRCard(shelfNumber, qrContent, contentType) {
            const container = document.getElementById('qrContainer');
            const card = document.createElement('div');
            card.className = 'qr-card';
            const qrId = `qr-${shelfNumber}-${Date.now()}`;
            card.innerHTML = `
                <h3>üö™ Shelf ${shelfNumber}</h3>
                <div id="${qrId}" class="qr-code"></div>
                <div class="instructions">
                    <strong>üì± How to Use:</strong><br>
                    1. Print this QR code<br>
                    2. Laminate for durability<br>
                    3. Attach to outside of shelf ${shelfNumber} door<br>
                    4. Students scan to unlock<br>
                    <strong style="color: #4CAF50;">‚úÖ QR Contains: ${qrContent}</strong>
                </div>
                ${contentType === 'UUID' ? `<div class="shelf-id">Type: ${contentType}</div>` : ''}
            `;
            container.appendChild(card);

            // Generate QR code using qrcodejs library
            if (typeof QRCode !== 'undefined') {
                const qrDiv = document.getElementById(qrId);
                
                new QRCode(qrDiv, {
                    text: qrContent,
                    width: 200,
                    height: 200,
                    colorDark: "#000000",
                    colorLight: "#ffffff",
                    correctLevel: QRCode.CorrectLevel.H
                });
            } else {
                console.error('QRCode library not loaded yet. Retrying...');
                setTimeout(() => {
                    card.remove();
                    createQRCard(shelfNumber, qrContent, contentType);
                }, 500);
            }
        }

        // Wait for page and QRCode library to load
        window.addEventListener('load', function() {
            // Check if QRCode is available
            const checkQRCode = setInterval(function() {
                if (typeof QRCode !== 'undefined') {
                    clearInterval(checkQRCode);
                    generateQRCodes();
                }
            }, 100);
            
            // Timeout after 5 seconds
            setTimeout(function() {
                clearInterval(checkQRCode);
                if (typeof QRCode === 'undefined') {
                    document.getElementById('qrContainer').innerHTML = 
                        '<div style="color: red; padding: 20px; text-align: center;">‚ùå QR Code library failed to load. Please refresh the page.</div>';
                }
            }, 5000);
        });
    </script>
</body>
</html>
